# プロジェクト構造ドキュメント

## 概要

AWS Typing Gameは、AWSサービス名のタイピング練習を通してAWSについて学習できる教育ゲームです。本プロジェクトは、モダンなPythonパッケージング標準に従い、保守性と拡張性を重視した設計となっています。

## アーキテクチャ概要

### 設計パターン

1. **マネージャーパターン**: 関心の分離による責務の明確化
2. **ステートマシンパターン**: ゲーム状態の管理
3. **モジュラー設計**: 機能別の明確な分離
4. **設定駆動設計**: 集約された設定管理

## ディレクトリ構造

```
q_dev_cli_game/
├── src/                          # メインソースコード (src-layout)
│   └── aws_typing_game/          # パッケージルート
│       ├── __init__.py           # パッケージ初期化
│       ├── main.py               # アプリケーション エントリーポイント
│       ├── core/                 # コアロジック
│       ├── managers/             # マネージャー群
│       ├── ui/                   # ユーザーインターフェース
│       ├── data/                 # ゲームデータ
│       └── utils/                # ユーティリティ関数
├── tests/                        # テストスイート
├── assets/                       # ゲーム素材
├── docs/                         # ドキュメント
├── scripts/                      # 開発・運用スクリプト
└── 設定ファイル群               # プロジェクト設定
```

## 各ディレクトリの詳細

### 🏗️ `src/aws_typing_game/` - メインパッケージ

#### `main.py` - アプリケーションエントリーポイント
- **責務**: ゲームの初期化と主ループの管理
- **主要機能**:
  - 全マネージャーの初期化と依存関係注入
  - ゲーム状態の遷移管理
  - イベント処理とディスパッチ
  - アクセシビリティ機能のハンドリング

### 🎯 `core/` - コアロジック

#### `game.py` - ゲームエンジン
- **責務**: ゲームロジックと状態管理
- **主要機能**:
  - タイピング検証とスコア計算
  - ゲーム進行の制御
  - 時間管理と制限時間の処理

#### `config.py` - 設定管理
- **責務**: 全設定の一元管理
- **設定クラス**:
  - `GameConfig`: ゲーム機能と表示設定
  - `Colors`: カラーシステムとアクセシビリティ
  - `UIConfig`: UI レイアウトと寸法
  - `FontConfig`: フォント設定
  - `AccessibilityConfig`: アクセシビリティ機能
  - `AnimationConfig`: アニメーション設定
  - `EvaluationConfig`: 評価基準とレベル閾値

### 🛠️ `managers/` - マネージャー群

#### `accessibility_manager.py` - アクセシビリティ
- **責務**: 色覚サポートとハイコントラストモード
- **機能**:
  - 色覚異常対応（4モード）
  - キーボードナビゲーション
  - ハイコントラストモード

#### `animation_manager.py` - アニメーション管理
- **責務**: 視覚効果とトランジション
- **機能**:
  - パーティクルエフェクト
  - 画面遷移アニメーション
  - タイピングフィードバック効果

#### `audio_manager.py` - 音響管理
- **責務**: 音響効果とBGM制御
- **機能**:
  - 効果音の再生とミキシング
  - BGMのランダム再生
  - ユーザー設定による音響制御

#### `data_manager.py` - データ管理
- **責務**: AWSサービスデータとハイスコア管理
- **機能**:
  - AWSサービス情報の読み込みと提供
  - ハイスコア永続化
  - データ検証と整合性チェック

#### `font_manager.py` - フォント管理
- **責務**: クロスプラットフォームフォント対応
- **機能**:
  - 日本語フォントの自動検出
  - プラットフォーム別フォント読み込み
  - フォントサイズの動的調整

#### `responsive_manager.py` - レスポンシブ設計
- **責務**: 画面サイズ適応とレイアウト最適化
- **機能**:
  - 解像度に応じた自動スケーリング
  - UI要素の動的配置
  - デバイス対応の最適化

### 🎨 `ui/` - ユーザーインターフェース

#### `ui_manager.py` - UI描画とレイアウト
- **責務**: 全ての描画処理とレイアウト管理
- **機能**:
  - 状態別画面描画（メニュー、ゲーム、結果、情報）
  - リアルタイムスコア表示
  - アクセシビリティ対応UI

### 📊 `data/` - ゲームデータ

#### `aws_services_data.json` - AWSサービス情報
- **内容**:
  - 80種類以上のAWSサービス情報
  - カテゴリ別分類（Computing, Storage, Database等）
  - ポジティブでユーモラスな英語文
  - 日本語翻訳
  - サービス説明と使用例

### 🔧 `utils/` - ユーティリティ
- **目的**: 共通の補助機能（将来の拡張用）

## 📁 `tests/` - テストスイート

### 構造
```
tests/
├── __init__.py              # テストパッケージ初期化
├── test_game.py            # ゲームロジックテスト
└── test_data_manager.py    # データ管理テスト（予定）
```

### テスト設定
- **フレームワーク**: pytest
- **設定**: `pyproject.toml`にテスト設定を定義
- **カバレッジ**: 拡張可能な設定

## 🎮 `assets/` - ゲーム素材

### 構造と用途
```
assets/
├── images/                  # 画像素材
│   └── README.txt          # 使用方法とガイドライン
├── sounds/                  # 効果音
│   └── README.txt          # 対応フォーマットと命名規則
└── music/                   # 背景音楽
    └── README.txt          # BGM仕様と実装方法
```

### 対応フォーマット
- **音響ファイル**: WAV, OGG, MP3
- **画像ファイル**: PNG, JPG
- **音響設計**: 8種類の効果音カテゴリ

## 📚 `docs/` - ドキュメント

### 目的
- プロジェクト構造の説明
- 開発ガイドライン
- API仕様書（将来予定）

## 🔨 `scripts/` - 開発・運用スクリプト

### 用途（計画中）
- ビルドスクリプト
- テスト自動化
- デプロイメント支援

## ⚙️ 設定ファイル群

### パッケージング設定
- **`pyproject.toml`**: モダンなPythonプロジェクト設定
  - プロジェクトメタデータ
  - 依存関係定義
  - ツール設定（Black, isort, pytest）
  - エントリーポイント定義

- **`setup.py`**: 後方互換性のための従来形式設定

### 依存関係管理
- **`requirements.txt`**: 基本依存関係
- **`uv.lock`**: 再現可能ビルドのためのロックファイル

### 品質管理
- **`.gitignore`**: バージョン管理除外設定
- **`LICENSE`**: MITライセンス

### ドキュメント
- **`README.md`**: 日本語でのインストール・使用方法
- **`CLAUDE.md`**: 開発者向けガイダンス

## 🔄 データフローと関係性

### 初期化フロー
1. `main.py` → 全マネージャーの初期化
2. `data_manager` → AWSサービスデータ読み込み
3. `responsive_manager` → 画面サイズ最適化
4. `ui_manager` → 描画システム準備

### ゲームループ
1. **イベント処理**: `main.py` → 各マネージャー
2. **状態更新**: `game.py` → スコア・時間管理
3. **描画**: `ui_manager` → 画面描画
4. **効果**: `animation_manager`, `audio_manager`

### データアクセス
```
game.py ←→ data_manager ←→ aws_services_data.json
   ↓
ui_manager ←→ font_manager, responsive_manager
   ↓
画面描画
```

## 🎯 設計の利点

### 保守性
- **関心の分離**: 各マネージャーは単一責務
- **依存関係注入**: テスタブルな設計
- **設定の外部化**: 動作変更の容易さ

### 拡張性
- **モジュラー設計**: 新機能追加の容易さ
- **インターフェース統一**: 一貫したAPI設計
- **プラグイン対応**: マネージャーの追加・置換

### 品質保証
- **型ヒント**: 開発時エラー検出
- **テストフレームワーク**: 自動テスト対応
- **リンター設定**: コード品質の維持

## 🔮 今後の拡張計画

### 短期的改善
1. テストカバレッジの拡大
2. 重複アセットディレクトリの統合
3. CI/CDパイプラインの構築

### 中長期的発展
1. 多言語対応の拡張
2. オンライン機能の追加
3. 学習進捗トラッキング
4. カスタムコンテンツ対応

---

このドキュメントは、プロジェクトの構造理解と開発効率向上を目的として作成されています。質問や提案がありましたら、適切なチャンネルを通じてお知らせください。